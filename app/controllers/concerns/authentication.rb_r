module Authentication
  extend ActiveSupport::Concern

  included do
    before_action :set_current_user
    before_action :protect_pages
    

    private
    
      def protect_pages
        redirect_to new_session_path, alert: t('common.not_logged_in') unless current_user
      end
      
  end
end